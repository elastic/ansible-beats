---
- name: Importing elastic GPG Key
  rpm_key:
    key: '{{ elastic_gpg_key }}'
    state: present
  register: installed_key
  until: installed_key is succeeded

- name: Add beats yum repository
  yum_repository:
    name: beats
    description: Beats repository
    file: '{{ beats_yum_repo_file }}'
    baseurl: '{{ repo_url }}'
    gpgcheck: true
    gpgkey: '{{ elastic_gpg_key }}'
    enabled: true
    state: present
